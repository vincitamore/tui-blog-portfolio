/**
 * Terminal Theme System
 * Inspired by classic terminal and editor themes
 */

export interface TerminalTheme {
  name: string;
  label: string;
  colors: {
    // Core
    background: string;
    foreground: string;
    // Accents
    primary: string;
    secondary: string;
    accent: string;
    // Status
    success: string;
    warning: string;
    error: string;
    info: string;
    // UI
    border: string;
    borderActive: string;
    muted: string;
    selection: string;
    // Syntax (for code blocks)
    comment: string;
    keyword: string;
    string: string;
    function: string;
  };
}

export const themes: Record<string, TerminalTheme> = {
  matrix: {
    name: 'matrix',
    label: 'Matrix',
    colors: {
      background: '#0a0e0a',
      foreground: '#00ff00',
      primary: '#00ff00',
      secondary: '#00cc00',
      accent: '#62ff94',
      success: '#00ff00',
      warning: '#ffff00',
      error: '#ff0000',
      info: '#00ffff',
      border: '#003300',
      borderActive: '#00ff00',
      muted: '#006600',
      selection: '#003300',
      comment: '#006600',
      keyword: '#00ff00',
      string: '#62ff94',
      function: '#00cc00',
    },
  },
  dracula: {
    name: 'dracula',
    label: 'Dracula',
    colors: {
      background: '#282a36',
      foreground: '#f8f8f2',
      primary: '#bd93f9',
      secondary: '#ff79c6',
      accent: '#50fa7b',
      success: '#50fa7b',
      warning: '#f1fa8c',
      error: '#ff5555',
      info: '#8be9fd',
      border: '#44475a',
      borderActive: '#bd93f9',
      muted: '#6272a4',
      selection: '#44475a',
      comment: '#6272a4',
      keyword: '#ff79c6',
      string: '#f1fa8c',
      function: '#50fa7b',
    },
  },
  monokai: {
    name: 'monokai',
    label: 'Monokai',
    colors: {
      background: '#272822',
      foreground: '#f8f8f2',
      primary: '#f92672',
      secondary: '#66d9ef',
      accent: '#a6e22e',
      success: '#a6e22e',
      warning: '#e6db74',
      error: '#f92672',
      info: '#66d9ef',
      border: '#3e3d32',
      borderActive: '#f92672',
      muted: '#75715e',
      selection: '#49483e',
      comment: '#75715e',
      keyword: '#f92672',
      string: '#e6db74',
      function: '#a6e22e',
    },
  },
  nord: {
    name: 'nord',
    label: 'Nord',
    colors: {
      background: '#2e3440',
      foreground: '#eceff4',
      primary: '#88c0d0',
      secondary: '#81a1c1',
      accent: '#a3be8c',
      success: '#a3be8c',
      warning: '#ebcb8b',
      error: '#bf616a',
      info: '#5e81ac',
      border: '#3b4252',
      borderActive: '#88c0d0',
      muted: '#4c566a',
      selection: '#434c5e',
      comment: '#616e88',
      keyword: '#81a1c1',
      string: '#a3be8c',
      function: '#88c0d0',
    },
  },
  tokyonight: {
    name: 'tokyonight',
    label: 'Tokyo Night',
    colors: {
      background: '#1a1b26',
      foreground: '#c0caf5',
      primary: '#7aa2f7',
      secondary: '#bb9af7',
      accent: '#9ece6a',
      success: '#9ece6a',
      warning: '#e0af68',
      error: '#f7768e',
      info: '#7dcfff',
      border: '#292e42',
      borderActive: '#7aa2f7',
      muted: '#565f89',
      selection: '#33467c',
      comment: '#565f89',
      keyword: '#bb9af7',
      string: '#9ece6a',
      function: '#7aa2f7',
    },
  },
  gruvbox: {
    name: 'gruvbox',
    label: 'Gruvbox',
    colors: {
      background: '#282828',
      foreground: '#ebdbb2',
      primary: '#fabd2f',
      secondary: '#83a598',
      accent: '#b8bb26',
      success: '#b8bb26',
      warning: '#fabd2f',
      error: '#fb4934',
      info: '#83a598',
      border: '#3c3836',
      borderActive: '#fabd2f',
      muted: '#665c54',
      selection: '#504945',
      comment: '#928374',
      keyword: '#fb4934',
      string: '#b8bb26',
      function: '#fabd2f',
    },
  },
  synthwave: {
    name: 'synthwave',
    label: 'Synthwave',
    colors: {
      background: '#262335',
      foreground: '#ffffff',
      primary: '#ff7edb',
      secondary: '#36f9f6',
      accent: '#fede5d',
      success: '#72f1b8',
      warning: '#fede5d',
      error: '#fe4450',
      info: '#36f9f6',
      border: '#34294f',
      borderActive: '#ff7edb',
      muted: '#848bbd',
      selection: '#463465',
      comment: '#848bbd',
      keyword: '#ff7edb',
      string: '#ff8b39',
      function: '#36f9f6',
    },
  },
  catppuccin: {
    name: 'catppuccin',
    label: 'Catppuccin',
    colors: {
      background: '#1e1e2e',
      foreground: '#cdd6f4',
      primary: '#cba6f7',
      secondary: '#f5c2e7',
      accent: '#a6e3a1',
      success: '#a6e3a1',
      warning: '#f9e2af',
      error: '#f38ba8',
      info: '#89dceb',
      border: '#313244',
      borderActive: '#cba6f7',
      muted: '#6c7086',
      selection: '#45475a',
      comment: '#6c7086',
      keyword: '#cba6f7',
      string: '#a6e3a1',
      function: '#89b4fa',
    },
  },
  solarized: {
    name: 'solarized',
    label: 'Solarized Dark',
    colors: {
      background: '#002b36',
      foreground: '#839496',
      primary: '#268bd2',
      secondary: '#2aa198',
      accent: '#859900',
      success: '#859900',
      warning: '#b58900',
      error: '#dc322f',
      info: '#2aa198',
      border: '#073642',
      borderActive: '#268bd2',
      muted: '#586e75',
      selection: '#073642',
      comment: '#586e75',
      keyword: '#859900',
      string: '#2aa198',
      function: '#268bd2',
    },
  },
  onedark: {
    name: 'onedark',
    label: 'One Dark',
    colors: {
      background: '#282c34',
      foreground: '#abb2bf',
      primary: '#61afef',
      secondary: '#c678dd',
      accent: '#98c379',
      success: '#98c379',
      warning: '#e5c07b',
      error: '#e06c75',
      info: '#56b6c2',
      border: '#3e4451',
      borderActive: '#61afef',
      muted: '#5c6370',
      selection: '#3e4451',
      comment: '#5c6370',
      keyword: '#c678dd',
      string: '#98c379',
      function: '#61afef',
    },
  },
  nightowl: {
    name: 'nightowl',
    label: 'Night Owl',
    colors: {
      background: '#011627',
      foreground: '#d6deeb',
      primary: '#82aaff',
      secondary: '#c792ea',
      accent: '#22da6e',
      success: '#22da6e',
      warning: '#ffcb8b',
      error: '#ef5350',
      info: '#7fdbca',
      border: '#1d3b53',
      borderActive: '#82aaff',
      muted: '#637777',
      selection: '#1d3b53',
      comment: '#637777',
      keyword: '#c792ea',
      string: '#ecc48d',
      function: '#82aaff',
    },
  },
  rosepine: {
    name: 'rosepine',
    label: 'RosÃ© Pine',
    colors: {
      background: '#191724',
      foreground: '#e0def4',
      primary: '#c4a7e7',
      secondary: '#ebbcba',
      accent: '#9ccfd8',
      success: '#31748f',
      warning: '#f6c177',
      error: '#eb6f92',
      info: '#9ccfd8',
      border: '#26233a',
      borderActive: '#c4a7e7',
      muted: '#6e6a86',
      selection: '#26233a',
      comment: '#6e6a86',
      keyword: '#c4a7e7',
      string: '#f6c177',
      function: '#ebbcba',
    },
  },
  everforest: {
    name: 'everforest',
    label: 'Everforest',
    colors: {
      background: '#2d353b',
      foreground: '#d3c6aa',
      primary: '#a7c080',
      secondary: '#7fbbb3',
      accent: '#dbbc7f',
      success: '#a7c080',
      warning: '#dbbc7f',
      error: '#e67e80',
      info: '#7fbbb3',
      border: '#3d484d',
      borderActive: '#a7c080',
      muted: '#859289',
      selection: '#3d484d',
      comment: '#859289',
      keyword: '#e67e80',
      string: '#a7c080',
      function: '#7fbbb3',
    },
  },
  kanagawa: {
    name: 'kanagawa',
    label: 'Kanagawa',
    colors: {
      background: '#1f1f28',
      foreground: '#dcd7ba',
      primary: '#7e9cd8',
      secondary: '#957fb8',
      accent: '#98bb6c',
      success: '#98bb6c',
      warning: '#dca561',
      error: '#c34043',
      info: '#7fb4ca',
      border: '#2a2a37',
      borderActive: '#7e9cd8',
      muted: '#727169',
      selection: '#2d4f67',
      comment: '#727169',
      keyword: '#957fb8',
      string: '#98bb6c',
      function: '#7e9cd8',
    },
  },
  palenight: {
    name: 'palenight',
    label: 'Palenight',
    colors: {
      background: '#292d3e',
      foreground: '#a6accd',
      primary: '#82aaff',
      secondary: '#c792ea',
      accent: '#c3e88d',
      success: '#c3e88d',
      warning: '#ffcb6b',
      error: '#f07178',
      info: '#89ddff',
      border: '#3a3f58',
      borderActive: '#82aaff',
      muted: '#676e95',
      selection: '#3a3f58',
      comment: '#676e95',
      keyword: '#c792ea',
      string: '#c3e88d',
      function: '#82aaff',
    },
  },
  horizon: {
    name: 'horizon',
    label: 'Horizon',
    colors: {
      background: '#1c1e26',
      foreground: '#d5d8da',
      primary: '#e95678',
      secondary: '#fab795',
      accent: '#29d398',
      success: '#29d398',
      warning: '#fab795',
      error: '#e95678',
      info: '#26bbd9',
      border: '#2e303e',
      borderActive: '#e95678',
      muted: '#6c6f93',
      selection: '#2e303e',
      comment: '#6c6f93',
      keyword: '#e95678',
      string: '#fab795',
      function: '#26bbd9',
    },
  },
  cobalt: {
    name: 'cobalt',
    label: 'Cobalt2',
    colors: {
      background: '#193549',
      foreground: '#ffffff',
      primary: '#ffc600',
      secondary: '#ff9d00',
      accent: '#3ad900',
      success: '#3ad900',
      warning: '#ffc600',
      error: '#ff628c',
      info: '#80ffbb',
      border: '#0d3a58',
      borderActive: '#ffc600',
      muted: '#0088ff',
      selection: '#0d3a58',
      comment: '#0088ff',
      keyword: '#ff9d00',
      string: '#3ad900',
      function: '#ffc600',
    },
  },
  ayu: {
    name: 'ayu',
    label: 'Ayu Mirage',
    colors: {
      background: '#1f2430',
      foreground: '#cbccc6',
      primary: '#ffcc66',
      secondary: '#f29e74',
      accent: '#87d96c',
      success: '#87d96c',
      warning: '#ffcc66',
      error: '#f28779',
      info: '#5ccfe6',
      border: '#33415e',
      borderActive: '#ffcc66',
      muted: '#5c6773',
      selection: '#33415e',
      comment: '#5c6773',
      keyword: '#ffa759',
      string: '#87d96c',
      function: '#ffcc66',
    },
  },
  amber: {
    name: 'amber',
    label: 'Amber CRT',
    colors: {
      background: '#0d0d0d',
      foreground: '#ffb000',
      primary: '#ffb000',
      secondary: '#ff8c00',
      accent: '#ffd700',
      success: '#ffd700',
      warning: '#ffb000',
      error: '#ff4500',
      info: '#ffa500',
      border: '#3d2800',
      borderActive: '#ffb000',
      muted: '#996600',
      selection: '#3d2800',
      comment: '#996600',
      keyword: '#ff8c00',
      string: '#ffd700',
      function: '#ffb000',
    },
  },
  github: {
    name: 'github',
    label: 'GitHub Dark',
    colors: {
      background: '#0d1117',
      foreground: '#c9d1d9',
      primary: '#58a6ff',
      secondary: '#d2a8ff',
      accent: '#7ee787',
      success: '#7ee787',
      warning: '#d29922',
      error: '#f85149',
      info: '#79c0ff',
      border: '#30363d',
      borderActive: '#58a6ff',
      muted: '#8b949e',
      selection: '#21262d',
      comment: '#8b949e',
      keyword: '#ff7b72',
      string: '#a5d6ff',
      function: '#d2a8ff',
    },
  },
  vscode: {
    name: 'vscode',
    label: 'VS Code Dark+',
    colors: {
      background: '#1e1e1e',
      foreground: '#d4d4d4',
      primary: '#569cd6',
      secondary: '#c586c0',
      accent: '#4ec9b0',
      success: '#6a9955',
      warning: '#dcdcaa',
      error: '#f44747',
      info: '#9cdcfe',
      border: '#3c3c3c',
      borderActive: '#569cd6',
      muted: '#808080',
      selection: '#264f78',
      comment: '#6a9955',
      keyword: '#569cd6',
      string: '#ce9178',
      function: '#dcdcaa',
    },
  },
  oceanicnext: {
    name: 'oceanicnext',
    label: 'Oceanic Next',
    colors: {
      background: '#1b2b34',
      foreground: '#d8dee9',
      primary: '#6699cc',
      secondary: '#c594c5',
      accent: '#99c794',
      success: '#99c794',
      warning: '#fac863',
      error: '#ec5f67',
      info: '#5fb3b3',
      border: '#343d46',
      borderActive: '#6699cc',
      muted: '#65737e',
      selection: '#343d46',
      comment: '#65737e',
      keyword: '#c594c5',
      string: '#99c794',
      function: '#6699cc',
    },
  },
};

const THEME_STORAGE_KEY = 'terminal-theme';
const DEFAULT_THEME = 'horizon';

export function getStoredTheme(): string {
  if (typeof window === 'undefined') return DEFAULT_THEME;
  return localStorage.getItem(THEME_STORAGE_KEY) || DEFAULT_THEME;
}

export function setStoredTheme(themeName: string): void {
  if (typeof window === 'undefined') return;
  localStorage.setItem(THEME_STORAGE_KEY, themeName);
}

export function applyTheme(themeName: string): TerminalTheme {
  const theme = themes[themeName] || themes.matrix;
  const root = document.documentElement;

  Object.entries(theme.colors).forEach(([key, value]) => {
    root.style.setProperty(`--term-${key}`, value);
  });

  setStoredTheme(themeName);
  return theme;
}

export function initTheme(): TerminalTheme {
  const themeName = getStoredTheme();
  return applyTheme(themeName);
}

